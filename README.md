语言：*简体中文* | [繁体中文](https://gitee.com/windwords/vChewing-macOS/blob/main/README-CHT.md)

---

因不可控原因，该仓库只能保证在 Gitee 有最新的内容可用：

- 下载：https://gitee.com/vchewing/vChewing-macOS/releases
- 代码仓库：https://gitee.com/vchewing/vChewing-macOS

# vChewing 威注音输入法

威注音输入法基于小麦注音二次开发，是**原生简体中文/繁体中文注音输入法**：

- 威注音是业界现阶段支持注音排列种类数量与输入用拼音种类数量最多的注音输入法。
  - 受威注音自家的铁恨注音并击引擎加持。
- 威注音的原厂词库内不存在任何可以妨碍该输入法在世界上任何地方传播的内容。
- 相比中州韵（鼠须管）而言，威注音能够做到真正的大千声韵并击。
- 拥有拼音并击模式，不懂注音的人群也可以受益于该输入法所带来的稳定的平均输入速度。
  - 相比小鹤双拼等双拼方案而言，威注音双手声韵分工明确、且重码率只有双拼的五分之一。
- 威注音对陆规审音完全兼容：不熟悉台澎金马审音的大陆用户不会遇到与汉字读音有关的不便。
  - 反之亦然。

>威注音有很多特色功能。在此仅枚举部分：
>- 支持 macOS 屏幕仿真键盘（仅传统大千与传统倚天布局）。
>- 可以将自己打的繁体中文自动转成日本 JIS 新字体来输出（包括基础的字词转换），也可以转成康熙繁体来输出。
>- 简繁体中文语料库彼此分离，彻底杜绝任何繁简转换过程可能造成的失误。
>- 支持近年的全字库汉字输入。
>- 可以自动整理用户语汇文档格式、自订联想词。
>- ……

威注音分支项目及威注音词库由孙志贵（Shiki Suen）维护。小麦注音官方原始仓库内的词库的内容均与孙志贵无关。

## 系统需求

建置用系统需求：至少 macOS 10.15 Catalina & Xcode 12。// 原因：Swift 包管理器支持所需。

编译出的成品对应系统需求：

- 至少 macOS El Capitan 10.11.5，否则无法处理 Unicode 8.0 的汉字。即便如此，仍需手动升级苹方至至少 macOS 10.12 开始随附的版本、以支持 Unicode 8.0 的通用规范汉字表用字（全字库没有「𫫇」字）。

    - 保留该系统支持的原因：非 Unibody 体型的 MacBook Pro 支持的最后一版 macOS 就是 El Capitan。

- **推荐最低系统版本**：macOS 10.12 Sierra，对 Unicode 8.0 开始的《通用规范汉字表》汉字有原生的苹方支持。

    - 同时建议**系统内存应至少 4GB**。威注音输入法占用内存约 115MB 左右（简繁双模式）、75MB左右（单模式），供参考。

	- 请务必使用 SSD 硬盘，否则可能会影响每次开机之后输入法首次加载的速度。从 10.10 Yosemite 开始，macOS 就已经是针对机械硬盘负优化的操作系统了。

    - 注：能装 macOS 10.13 High Sierra 就不要去碰 macOS 10.12 Sierra 这个半成品。

- 关于全字库支持，因下述事实而在理论上很难做到最完美：

    - 很可惜 GB18030-2005 并没有官方提供的逐字读音对照表，所以目前才用了全字库。然而全字库并不等于完美。

    - 有条件者可以安装全字库字体与花园明朝，否则全字库等高万国码码位汉字可能无法在输入法的选字窗内完整显示。
 
    - 全字库汉字显示支持会受到具体系统版本对万国码版本的支持的限制。
 
    - 有些全字库汉字一开始会依赖万国码的私人造字区，且在之后被新版本万国码所支持。
 
## 建置流程

安装 Xcode 之后，请先配置 Xcode 允许其直接构建在项目所在的文档夹下的 build 文档夹内。步骤：
```
「Xcode」->「Preferences...」->「Locations」；
「File」->「Project/WorkspaceSettings...」->「Advanced」；
选「Custom」->「Relative to Workspace」即可。否则，make 的过程会出错。
```
在终端机内定位到威注音的克隆本地项目的本地仓库的目录之后，运行 `make update` 以获取最新词库。

接下来就是直接开 Xcode 项目，Product -> Scheme 选「vChewingInstaller」，编译即可。

> 之前说「在成功之后运行 `make` 即可组建、再运行 `make install` 可以触发威注音的安装进程」，这对新版威注音而言**当且仅当**使用纯 Swift 编译脚本工序时方可使用。目前的 libvchewing-data 模块已经针对 macOS 版威注音实装了纯 Swift 词库编译脚本。

第一次安装完，日后代码或词库有任何修改，只要重复上述流程，再次安装威注音即可。

要注意的是 macOS 可能会限制同一次 login session 能终结同一个输入法的运行进程的次数（安装进程通过 kill input method process 来让新版的输入法生效）。如果安装若干次后，发现进程修改的结果并没有出现、或甚至输入法已无法再选用，只需要注销目前的 macOS 系统帐号、再重新登录即可。

补记: 该输入法是在 2021 年 11 月初「28ae7deb4092f067539cff600397292e66a5dd56」这一版小麦注音建置的基础上完成的。因为在清洗词库的时候清洗了全部的 git commit 历史，所以无法自动从小麦注音官方仓库上游继承任何改动，只能手动同步任何在此之后的进程修正。最近一次同步参照是上游主仓库的 2.2.2 版、以及 zonble 的分支「5cb6819e132a02bbcba77dbf083ada418750dab7」。

## 应用授权

小麦注音引擎进程版权（MIT 授权）：© 2011-2021 OpenVanilla 项目团队（Mengjuei Hsieh, Lukhnos Liu, Zonble Yang, 等）。

威注音项目仅用到小麦注音的下述进程组件：

- 状态管理引擎 & NSStringUtils & FSEventStreamHelper (by Zonble Yang)。

- 半衰记忆模块，因故障暂时无法激活 (by Mengjuei Hsieh)。

- 仅供研发人员调试方便而使用的 App 版安装进程 (by Zonble Yang)。

- Voltaire MK2 选字窗、飘云通知窗口、工具提示 (by Zonble Yang)，有大幅度修改。

威注音输入法 macOS 版以 MIT-NTL License 授权发布 (与 MIT 兼容)：© 2021-2022 vChewing 项目。

- 威注音输入法 macOS 版进程维护：Shiki Suen。特别感谢 Isaac Xen 与 Hiraku Wong 等人的技术协力。

- 铁恨注音并击处理引擎：Shiki Suen (MIT-NTL License)。

- 天权星语汇处理引擎：Shiki Suen (MIT-NTL License)，针对「Lukhnos Liu 用 C++ 写的 Gramambular」用 Swift 彻底重写而成。

- 威注音词库由 Shiki Suen 维护，以 3-Clause BSD License 授权发布。其中的词频数据[由 NAER 授权用于非商业用途](https://twitter.com/ShikiSuen/status/1479329302713831424)。

用户可自由使用、散播本软件，惟散播时必须完整保留版权声明及软件授权、且一旦经过修改便不可以再继续使用威注音的产品名称。

## 格式规范等与参与研发时需要注意的事项

该项目对源码格式有规范，且 Swift 与其他 (Obj)C(++) 系语言持不同规范：

请查看该仓库内的「[CONTRIBUTING.md](./CONTRIBUTING.md)」文档。

## 其他

为了您的精神卫生，任何使用威注音输入法时遇到的产品问题、请勿提报至小麦注音，除非您确信小麦注音也有该问题。即便如此，也请在他们那边不要提及威注音。

滥用沉默权来浪费对方的时间与热情，也是一种暴力。**当对方最最最开始就把你当敌人的时候，你连呼吸都是错的**。

其实我满怀念上游项目还没被 Lukhnos Liu 接管收入 OpenVanilla 的那个年代。MJHsieh 主导开发小麦注音的时候，且不讨论他立场怎样，但基础的技术交流是完全没问题的。LibChewing 那边也是，正常交流完全没问题。

有些事情，继续争论下去也没用。本来我想着重写 ctlInputMethod 撤掉 zonble 的状态管理引擎的，毕竟有大陆同乡写的火山五笔输入法的框架套上我的铁恨注音并击引擎可以直接用。但这样赌气对谁都没好处。眼下，威注音 macOS 版还需要一些小维护。之后我就得开始考虑用 Windows 平台可用的除了 C++ 以外的语言重写铁恨注音并击引擎与天权星语汇引擎、方便接下来威注音的 Windows 版本的研发。能将 Lukhnos 的 C++ 内容全部换掉、彻底砸碎套在威注音身上的名为 C++ 的枷锁、让威注音有一个自由的未来，我已经知足了。让更多的人用上好用的输入法，才是最重要的。**这个重要性，不是 zonble 用「私人需求」这种帽子扣过来、就可以泯灭了的**。

$ EOF.
